<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ebook3.0</title>
</head>

<body>
    <h1>ebook3.0</h1>
    <h4>Shayne C出品</h4>
    <button onclick="post()">post请求</button>
    <button onclick="get()">get请求</button>
    <button onclick="addProcess()">新建教学过程</button>
    <button onclick="max()">最大化</button>
    <button onclick="min()">最小化</button>
    <button onclick="exitApp()">关闭</button>
    <button onclick="fullscreen()">全屏（F2）</button>
    <button onclick="developTools()">开发者工具（ctrl + shift + i）</button>
    <input type="text" name="" value="">
    <button type="button" name="button" onclick="uploadFiles({
        'url':'http://pan.tes-sys.com/skydisk-ms/api/fileUpload.html',
        'd': '80C32BDE0C6EB8F1BE8C202B7DF95286',
        'dir_id': '4262EE8CB97BD59D044FD66DCC66C068',
        'pub_flag': '2',
        'user_id': 'B220F7C944ECD1DDD0BF063F4439E961',
        'response_url': ''
    })">上传文件测试</button>
    <button class="stopUpload" type="button" name="button">停止上传</button>
    <button class="stopDownload" type="button" name="button">停止下载</button>
    <a target="_blank" href="http://pan.tes-sys.com/tesfs/file/download.html?id=4E650CAD972874984AEF1B3C996FD28C">自动下载测试</a>
    <a target="_blank" href="http://pan.tes-sys.com/tesfs/file/download.html?id=F462F267203AB7E683E318322641D264">自动下载测试2</a>
    <button class="download" type="button" url="http://pan.tes-sys.com/tesfs/file/download.html?id=F462F267203AB7E683E318322641D264" name="button">手动下载测试</button>

    <p>下载进度：</p>
    <div class="progress" style="height:10px;background:#47f3fe;width:0px;margin-top:20px"><span></span></div>
</body>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
    // 上传文件接口--这里的上传文件是指上传至网盘，相应的参数参考网盘上传的api
    function uploadFiles(data) {
        app.send('uploadFiles', data)
    }
    // post请求接口
    function post() {
        app.send('httpPost', {
            url: 'http://es.tes-sys.com/weare/login',
            data: {
                username: 'chenshenhao',
                password: 'chenshenhao'
            },
            callback: 'httpPostCallback'
        })
        app.once('httpPostCallback', function(event, mess) {
            alert('post请求成功\n' + mess)
        })
    }
    // post请求接口
    function addProcess() {
        app.send('addProcess', {
            info: {
                'book_id': '测试',
                'user_id': '测试',
                'page_id': '测试',
                'count': '测试',
                'pos_x': '测试',
                'pos_y': '测试'
            },
            data: [{
                'file_id': '测试',
                'detail_index': 0,
                'file_name': '测试',
                'ext_name': '测试',
                'edit_name': '测试'
            }, {
                'file_id': '测试',
                'detail_index': 0,
                'file_name': '测试',
                'ext_name': '测试',
                'edit_name': '测试'
            }, {
                'file_id': '测试',
                'detail_index': 0,
                'file_name': '测试',
                'ext_name': '测试',
                'edit_name': '测试'
            }, {
                'file_id': '测试',
                'detail_index': 0,
                'file_name': '测试',
                'ext_name': '测试',
                'edit_name': '测试'
            }, {
                'file_id': '测试',
                'detail_index': 0,
                'file_name': '测试',
                'ext_name': '测试',
                'edit_name': '测试'
            }],
            callback: 'addProcessCallback'
        })
        app.once('addProcessCallback', function(event, mess) {
            alert('新建教学过程请求成功\n' + mess)
        })
    }

    // get请求接口
    function get() {
        app.send('httpGet', {
            url: 'http://es.tes-sys.com/weare/getWholeProjectTeam',
            callback: 'httpGetCallback'
        })
        app.once('httpGetCallback', function(event, mess) {
            alert('get请求成功\n' + mess)
        })
    }
    // 最小化接口
    function min() {
        app.send('minimize')
    }
    // 最大化接口
    function max() {
        app.send('Maximization')
    }
    // 退出app接口
    function exitApp() {
        app.send('exit')
    }
    // 全屏接口
    function fullscreen() {
        app.send('fullscreen')
    }
    // 开发者工具接口
    function developTools() {
        app.send('developTools')
    }

    $(".stopUpload").click(function(event) {
        var id = $(this).attr('uploadid');
        // 停止上传接口
        app.send('stopUpload', {
            id: id,
            callback: 'stopUploadCallback'
        })
        app.once('stopUploadCallback', function(event, mess) {
            alert("停止上传" + mess)
        })
    });
    $(".stopDownload").click(function(event) {
        var id = $(this).attr('downloadid');
        // 停止下载接口
        app.send('stopDownload', {
            id: id,
            callback: 'stopDownloadCallback'
        })
        app.once('stopDownloadCallback', function(event, mess) {
            alert("停止下载" + mess)
        })
    });
    $(".download").click(function(event) {
        var url = $(this).attr('url');
        // 下载固定地址的文件接口
        app.send('downloadFile', url)
    });


    app.on('uploadStart', (event, message) => {
        let obj = JSON.parse(message);
        console.log(obj.id)
        console.log("开始上传");
        $(".stopUpload").attr('uploadid', obj.id);
    })
    app.on('downloadStart', (event, message) => {
        let obj = JSON.parse(message);
        console.log(obj.id)
        console.log("开始下载");
        $(".stopDownload").attr('downloadid', obj.id);
    })

    // 上传、下载相关接口-----》
    // 其中，返回的message中有相应的itemID，可根据相应的id设定相应的进度条、停止等控制
    // app.on('uploadProgress', uploadProgress)
    // app.on('uploadStart', uploadStart)
    // app.on('uploadSuccess', uploadSucess)
    // app.on('uploadFailed', uploadFailed)
    // app.on('downloadProgress', downloadProgress)
    // app.on('downloadStart', downloadStart)
    // app.on('downloadSuccess', downloadSucess)
    // app.on('downloadFailed', downloadFailed)
</script>

</html>
